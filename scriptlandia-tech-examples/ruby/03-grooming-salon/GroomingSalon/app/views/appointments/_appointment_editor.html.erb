<!-- -->
 
  <%= f.error_messages %>

  <%
    if mode == 'new'
      submitText = "Create"
    else
      submitText = "Update"
    end

    if User.create.current_user(session).admin
      disabled = false    
    else 
      if mode == 'edit' || params[:pet_id] != nil
        disabled = true
      else
        disabled = false
      end
    end

    if User.create.current_user(session).admin
      conditions = []
    else
      #conditions = [ "company_id=?", User.create.current_user(session).company_id ]
conditions = []
    end
  %>

  <% if disabled %>
    <%= f.hidden_field :pet_id %>
    <%= f.hidden_field :pet_owner_id %>
  <% end %>

  <p>
    <%= f.label :'pet Owner' %><br />
    <%= collection_select(:appointment, :pet_owner_id, 
          PetOwner.find(:all, :order => "lastName", :conditions => conditions), :id, :name, {:include_blank => true}, {:disabled => disabled }) %>

    <%= observe_field("appointment_pet_owner_id",
                   :frequency => 0.25,
                   :update => :display_pets_select_div,
                   :url => { :controller => 'appointments', :action => :display_pets_select},
                   :with => 'pet_owner_id') %>
  </p>
       
  <p>
    <%= f.label :'Pet' %><br />

    <div id="display_pets_select_div"></div>
  </p>

  <p>
    <%= f.label :'groomer' %><br />

    <%= collection_select(:appointment, :groomer_id, 
          Groomer.find(:all, :order => "lastName", :conditions => conditions ), :id, :name) %>

  </p>

  <p>
    <%= f.label :'appointment Date' %><br />
    <%= f.datetime_select :appointmentDate %>
  </p>

  <p>
    <%= f.label :price %><br />
    <%= f.text_field :price %>
  </p>

  <p>
    <%= f.submit submitText %>

    <%= link_to 'Cancel', appointments_path %>
  </p>

