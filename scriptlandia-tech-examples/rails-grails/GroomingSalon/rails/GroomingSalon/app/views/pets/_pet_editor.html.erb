  <%= f.error_messages %>

  <%
    if mode == 'new'
      submit_text = "Create"
    else
      submit_text = "Update"
    end

    current_user = User.current_user(session)

    if current_user.admin
      conditions = []
    else
      conditions = [ "company_id=?", current_user.company_id ]
    end

    disabled = (params[:pet_owner_id] != nil)

    puts "!!!" + @pet.subtype.to_s

    breeds = Pet.get_breeds @pet.subtype

puts "!!!breeds " + breeds.to_s
  %>

  <table width="100%">
    <tr>
      <td>
        <%= f.label :'pet Owner' %>: 
        <%= collection_select(:pet, :pet_owner_id, 
              PetOwner.find(:all, :order => "last_name", :conditions => conditions ),
              :id, :name, {}, {:disabled => disabled }) %>
      </td>

      <td>
        <%= "Cat or Dog?" %>: <%= select(:pet, :subtype, %w(cat dog)) %>
      </td>

      <td>
        <%= f.label :name %>: <%= f.text_field :name %>
      </td>
    </tr>

    <tr>
      <td>
        <%= f.label :breed %>:
        <%= observe_field("pet_subtype",
                       :frequency => 0.25,
                       :update => :display_breeds_select_div,
                       :url => { :controller => 'pets', :action => :display_breeds_select},
                       :with => 'subtype') %>
        <div id="display_breeds_select_div">
          <%= collection_select(:pet, :breed, breeds, :to_s, :to_s, {}, {:disabled => disabled}) %>
        </div>
      </td>

      <td>
        <%= f.label :size %>: <%= f.text_field :size %>
      </td>

      <td>
        <%= f.label :color %>: <%= f.text_field :color %>
      </td>
    </tr>

    <tr>
      <td>
        <%= f.label :'birth Date' %>: <%= date_select(:pet, :birth_date, :order => [:month, :day, :year])%>
      </td>

      <td>
        <%= f.label :sex %>: <%= select(:pet, :sex, %w(male female)) %>
      </td>

      <td>
        <%= f.label :'alive' %>: <%= select(:pet, :alive, %w(yes no)) %>
      </td>
    </tr>

    <tr>
      <td>
        <%= f.label :veterinar %>: <%= f.text_field :veterinar %>
      </td>

      <td>
        <%= f.label :'referred By' %>: <%= f.text_field :referred_by %>
      </td>
    </tr>

    <tr>
      <td colspan="3">
        <table>
          <tr>
            <td><%= f.label :'medical Problems' %>:</td>
            <td><%= f.label :'special Instructions' %>:</td>
            <td><%= f.label :behavior %>:</td>
          </tr>

          <tr>
            <td><%= f.text_area :medical_problems, "cols" => 25, "rows" => 5 %></td>
            <td><%= f.text_area :special_instructions, "cols" => 25, "rows" => 5 %></td>
            <td><%= f.text_area :behavior, "cols" => 25, "rows" => 5 %></td>
          </tr>
        </table>
      </td>
    </tr>

    <tr>
      <td colspan="3">
        <%= f.label :'clip 1' %>: <%= f.text_field :clip1 %>
      </td>
    </tr>

    <tr>
      <td colspan="3">
        <%= f.label :'clip 2' %>: <%= f.text_field :clip2 %>
      </td>
    </tr>

    <tr>
      <td colspan="3">
        <%= f.label :'clip 3' %>: <%= f.text_field :clip3 %>
      </td>
    </tr>

    <tr>
      <td>
        <div>
          <%= f.submit submit_text %> <%= link_to 'Cancel', pets_path %>
        </div>
      </td>
    </tr>
  </table>
