<!-- -->

<%= f.error_messages %>

<%
  if mode == 'new'
    submit_text = "Create"
  else
    submit_text = "Update"
  end

  current_user = User.current_user(session)

  if current_user.admin
    conditions = []
  else
    conditions = [ "company_id=?", current_user.company_id ]
  end

  disabled = (params[:pet_owner_id] != nil)

  breeds = Pet.get_breeds @pet.subtype
%>

<%= javascript_include_tag "scriptaculous/prototype" %>

<%= javascript_include_tag "scriptaculous/scriptaculous" %>

<script type="text/javascript">
  function toggleLayers(el) {
    var el1 = document.getElementById('display_cat_breeds_select_div'); 
    var el2 = document.getElementById('display_dog_breeds_select_div');

    if(el.selectedIndex == 0) {
      el2.style.display='none'; 
      el1.style.display=''; 
    }
    else {
      el1.style.display='none'; 
      el2.style.display=''; 
    }
   }
</script>

<table width="100%">
  <tr>
    <td>
      <%= f.label :'pet Owner' %>: 
      <%= collection_select(:pet, :pet_owner_id, 
            PetOwner.find(:all, :order => "last_name", :conditions => conditions ),
            :id, :name, {}, {:disabled => disabled }) %>
    </td>

    <td>
      <%= "Cat or Dog?" %>: <%= select(:pet, :subtype, %w(cat dog), {}, {:onchange => "toggleLayers(this);"}) %>
    </td>

    <td>
      <%= f.label :name %>: <%= f.text_field :name %>
    </td>
  </tr>

  <tr>
    <td>
      <%= f.label :breed %>:
      <div id="display_cat_breeds_select_div">
        <%= text_field_with_auto_complete(:cat, :breed, :autocomplete => "off") %>
      </div>
     <div id="display_dog_breeds_select_div">
        <%= text_field_with_auto_complete(:dog, :breed, :autocomplete => "off") %>
      </div>      
    </td>

    <td>
      <%= f.label :size %>: <%= f.text_field :size %>
    </td>

    <td>
      <%= f.label :color %>: <%= f.text_field :color %>
    </td>
  </tr>

  <tr>
    <td>
      <%= f.label :'birth Date' %>: <%= date_select(:pet, :birth_date, :order => [:month, :day, :year])%>
    </td>

    <td>
      <%= f.label :sex %>: <%= select(:pet, :sex, %w(male female)) %>
    </td>

    <td>
      <%= f.label :'alive' %>: <%= select(:pet, :alive, %w(yes no)) %>
    </td>
  </tr>

  <tr>
    <td>
      <%= f.label :veterinar %>: <%= f.text_field :veterinar %>
    </td>

    <td>
      <%= f.label :'referred By' %>: <%= f.text_field :referred_by %>
    </td>
  </tr>

  <tr>
    <td colspan="3">
      <table>
        <tr>
          <td><%= f.label :'medical Problems' %>:</td>
          <td><%= f.label :'special Instructions' %>:</td>
          <td><%= f.label :behavior %>:</td>
        </tr>

        <tr>
          <td><%= f.text_area :medical_problems, "cols" => 25, "rows" => 5 %></td>
          <td><%= f.text_area :special_instructions, "cols" => 25, "rows" => 5 %></td>
          <td><%= f.text_area :behavior, "cols" => 25, "rows" => 5 %></td>
        </tr>
      </table>
    </td>
  </tr>

  <tr>
    <td colspan="3">
      <%= f.label :'clip 1' %>: <%= f.text_field :clip1 %>
    </td>
  </tr>

  <tr>
    <td colspan="3">
      <%= f.label :'clip 2' %>: <%= f.text_field :clip2 %>
    </td>
  </tr>

  <tr>
    <td colspan="3">
      <%= f.label :'clip 3' %>: <%= f.text_field :clip3 %>
    </td>
  </tr>

  <tr>
    <td>
      <div>
        <%= f.submit submit_text %> <%= link_to 'Cancel', pets_path %>
      </div>
    </td>
  </tr>
</table>
